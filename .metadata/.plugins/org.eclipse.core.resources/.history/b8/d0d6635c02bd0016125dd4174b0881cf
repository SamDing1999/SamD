package fracCalc;

import java.util.Scanner;

public class FracCalc {

    public static void main(String[] args) 
    {
        // TODO: Read the input from the user and call produceAnswer with an equation
    	Scanner userInput = new Scanner(System.in);
    	System.out.println("Enter your operation.");
    	String expression = userInput.nextLine();
    	while (expression!=("quit")){
    		
    		String answer = produceAnswer(expression);
    		System.out.println(answer);
    		System.out.println("Enter your operation.");
    		expression = userInput.nextLine();
    	}
    }
    
    // ** IMPORTANT ** DO NOT DELETE THIS FUNCTION.  This function will be used to test your code
    // This function takes a String 'input' and produces the result
    //
    // input is a fraction string that needs to be evaluated.  For your program, this will be the user input.
    //      e.g. input ==> "1/2 + 3/4"
    //        
    // The function should return the result of the fraction after it has been calculated
    //      e.g. return ==> "1_1/4"
    public static String produceAnswer(String input)
    { 
        // TODO: Implement this function to produce the solution to the input
    	String firstOperand = new String();
		String operator = new String();
		String secondOperand = new String();
		int firstSpace = input.indexOf(" ");
    	int secondSpace = input.indexOf(" ", firstSpace+1);
    	operator = input.substring(firstSpace+1, secondSpace);
    	firstOperand = input.substring(0, firstSpace);
    	secondOperand = input.substring(secondSpace+1, input.length());
    	
    	String answer;
    

	
		if(operator.equals("+")){
			//addition
			answer = addFrac(parseOperand(firstOperand, secondOperand));
		}else if(operator.equals("-")){
			//subtraction
			answer = subtractFrac(parseOperand(firstOperand, secondOperand));
		}else if(operator.equals("*")){
			//multiplication
			answer = multiplyFrac(parseOperand(firstOperand, secondOperand));
		}else if(operator.equals("/")){
			//division
			answer = divideFrac(parseOperand(firstOperand, secondOperand));
		}else{
			answer = "Please check your expression";
		}
		
	
	    return answer;
}

   
    
    public static int[] parseOperand(String firstOperand, String secondOperand){
    	int[] parseOfTwoOperands = new int[4];
    	
    	//firstOperand
    	int[] parseOfFirst = new int[3];
    	if(firstOperand.indexOf("_")>0){
    		//mixed fraction
    		parseOfFirst[0] = Integer.parseInt(firstOperand.substring(0,firstOperand.indexOf("_")));
    		parseOfFirst[1] = Integer.parseInt(firstOperand.substring(firstOperand.indexOf("_")+1,firstOperand.indexOf("/")));
    		parseOfFirst[2] = Integer.parseInt(firstOperand.substring(firstOperand.indexOf("/")+1));
    	}else if(firstOperand.indexOf("/")>0){
    		//improperFraction
    		parseOfFirst[0] = 0;
    		parseOfFirst[1] = Integer.parseInt(firstOperand.substring(0,firstOperand.indexOf("/")));
    		parseOfFirst[2] = Integer.parseInt(firstOperand.substring(firstOperand.indexOf("/")+1));
    	}else{
    		//integers
    		parseOfFirst[0] = Integer.parseInt(firstOperand);
    		parseOfFirst[1] = 0;
    	    parseOfFirst[2] = 1;
    	}
    	if(parseOfFirst[0] >= 0){
    		parseOfTwoOperands[0] = (parseOfFirst[0]*parseOfFirst[2]) + parseOfFirst[1];
    	}else{
    		parseOfTwoOperands[0] = (parseOfFirst[0]*parseOfFirst[2]) - parseOfFirst[1];    	
    	}
    	parseOfTwoOperands[1] = parseOfFirst[2];
    	
    	//secondOperand
    	int[] parseOfSecond = new int[3];
    	if(firstOperand.indexOf("_")>0){
    		//mixed fraction
    		parseOfSecond[0] = Integer.parseInt(secondOperand.substring(0,secondOperand.indexOf("_")));
    		parseOfSecond[1] = Integer.parseInt(secondOperand.substring(secondOperand.indexOf("_")+1,secondOperand.indexOf("/")));
    		parseOfSecond[2] = Integer.parseInt(secondOperand.substring(secondOperand.indexOf("/")+1));
    	}else if(firstOperand.indexOf("/")>0){
    		
    		//improperFraction
    		parseOfSecond[0] = 0;
    		parseOfSecond[1] = Integer.parseInt(secondOperand.substring(0,secondOperand.indexOf("/")));
    		parseOfSecond[2] = Integer.parseInt(secondOperand.substring(secondOperand.indexOf("/")+1));
    	}else{
    		//integers
    		parseOfSecond[0] = Integer.parseInt(secondOperand);
    		parseOfSecond[1] = 0;
    		parseOfSecond[2] = 1;
    		
    	}
    	
    	if(parseOfSecond[0]>=0){
    		parseOfTwoOperands[2] = (parseOfSecond[0]*parseOfSecond[2])+ parseOfSecond[1];
    	}else{
    		parseOfTwoOperands[2] = (parseOfSecond[0]*parseOfSecond[2])- parseOfSecond[1];
    	}
    	parseOfTwoOperands[3] = parseOfSecond[2];
    	
    	return parseOfTwoOperands;
    	
    }
    
    
    
    public static String addFrac(int[] parseOfTwoOperands){
    	String answer;
    	int numeratorOne = parseOfTwoOperands[0];
    	int denominatorOne = parseOfTwoOperands[1];
    	int numeratorTwo = parseOfTwoOperands[2];
    	int denominatorTwo = parseOfTwoOperands[3];
    	
    	int numerator = numeratorOne*denominatorTwo+numeratorTwo*denominatorOne;
    	int denominator	= denominatorOne*denominatorTwo;
    	
    	
    	
    	int gcf = Calculate.gcf(numerator, denominator);
    	answer = Calculate.toMixedNum(numerator/gcf, denominator/gcf);
    	
    	return answer;
    	
    }
    
    public static String subtractFrac(int[] parseOfTwoOperands){
    	String answer;
    	int numeratorOne = parseOfTwoOperands[0];
    	int denominatorOne = parseOfTwoOperands[1];
    	int numeratorTwo = parseOfTwoOperands[2];
    	int denominatorTwo = parseOfTwoOperands[3];
    	
    	int numerator = numeratorOne*denominatorTwo-numeratorTwo*denominatorOne;
    	int denominator =  denominatorOne*denominatorTwo;
    	
    	int gcf = Calculate.gcf(numerator, denominator);
    	answer = Calculate.toMixedNum(numerator/gcf, denominator/gcf);
    	return answer;
    }
    
    public static String multiplyFrac(int[] parseOfTwoOperands){
    	String answer;
    	int numeratorOne = parseOfTwoOperands[0];
    	int denominatorOne = parseOfTwoOperands[1];
    	int numeratorTwo = parseOfTwoOperands[2];
    	int denominatorTwo = parseOfTwoOperands[3];
        
        int numerator = numeratorOne*numeratorTwo;
        int denominator = denominatorOne*denominatorTwo;
        
        int gcf = Calculate.gcf(numerator, denominator);
    	answer = Calculate.toMixedNum(numerator/gcf, denominator/gcf);
        return answer;
    }
    
    public static String divideFrac(int[] parseOfTwoOperands){
    	String answer;
    	int numeratorOne = parseOfTwoOperands[0];
    	int denominatorOne = parseOfTwoOperands[1];
    	int numeratorTwo = parseOfTwoOperands[2];
    	int denominatorTwo = parseOfTwoOperands[3];
    	
    	int numerator = numeratorOne*denominatorTwo;
    	int denominator = numeratorTwo*denominatorOne;
    	
    	int gcf = Calculate.gcf(numerator, denominator);
    	answer = Calculate.toMixedNum(numerator/gcf, denominator/gcf);
    	return answer;
    }
    
}
    
    
